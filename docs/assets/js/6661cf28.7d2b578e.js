"use strict";(self.webpackChunkfhir_fli_documentation=self.webpackChunkfhir_fli_documentation||[]).push([[661],{6501:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"fhir_r4_validation","title":"Validation Package","description":"The fhirr4validation library provides comprehensive validation functionality for FHIR R4 resources. It validates resources against their StructureDefinitions, checking structure, cardinality, bindings, extensions, and invariants to ensure compliance with the FHIR specification.","source":"@site/docs/fhir_r4_validation.md","sourceDirName":".","slug":"/fhir_r4_validation","permalink":"/fhir_fli_documentation/docs/fhir_r4_validation","draft":false,"unlisted":false,"editUrl":"https://github.com/fhir-fli/fhir_fli_documentation/tree/main/docs/fhir_r4_validation.md","tags":[],"version":"current","frontMatter":{"id":"fhir_r4_validation","title":"Validation Package"},"sidebar":"tutorialSidebar","previous":{"title":"FHIRPath Package","permalink":"/fhir_fli_documentation/docs/fhir_r4_path"},"next":{"title":"FHIR Mapping Package","permalink":"/fhir_fli_documentation/docs/mapping/fhir_mapping"}}');var a=n(4848),t=n(8453);const s={id:"fhir_r4_validation",title:"Validation Package"},l="FHIR R4 Validation",o={},d=[{value:"Installation",id:"installation",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Validating a FHIR Resource",id:"validating-a-fhir-resource",level:3},{value:"Validating from JSON",id:"validating-from-json",level:3},{value:"Validation Results",id:"validation-results",level:2},{value:"ValidationDiagnostics",id:"validationdiagnostics",level:3},{value:"Validation Types",id:"validation-types",level:2},{value:"1. Structure Validation",id:"1-structure-validation",level:3},{value:"2. Cardinality Validation",id:"2-cardinality-validation",level:3},{value:"3. Binding Validation",id:"3-binding-validation",level:3},{value:"4. Extension Validation",id:"4-extension-validation",level:3},{value:"5. Invariant Validation",id:"5-invariant-validation",level:3},{value:"Providing StructureDefinitions",id:"providing-structuredefinitions",level:2},{value:"Questionnaire Response Validation",id:"questionnaire-response-validation",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Advanced Usage",id:"advanced-usage",level:2},{value:"Custom HTTP Client",id:"custom-http-client",level:3},{value:"Resource Cache",id:"resource-cache",level:3},{value:"Example: Complete Validation Workflow",id:"example-complete-validation-workflow",level:2},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Integration with Other Packages",id:"integration-with-other-packages",level:2},{value:"Conclusion",id:"conclusion",level:2}];function c(e){const i={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.header,{children:(0,a.jsx)(i.h1,{id:"fhir-r4-validation",children:"FHIR R4 Validation"})}),"\n",(0,a.jsxs)(i.p,{children:["The ",(0,a.jsx)(i.code,{children:"fhir_r4_validation"})," library provides comprehensive validation functionality for FHIR R4 resources. It validates resources against their StructureDefinitions, checking structure, cardinality, bindings, extensions, and invariants to ensure compliance with the FHIR specification."]}),"\n",(0,a.jsx)(i.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-yaml",children:"dependencies:\n  fhir_r4_validation: ^0.4.0\n  fhir_r4: ^0.4.3\n  fhir_r4_path: ^0.4.4\n"})}),"\n",(0,a.jsx)(i.h2,{id:"key-features",children:"Key Features"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"Structure Validation"}),": Validates that resources conform to their StructureDefinition"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"Cardinality Validation"}),": Ensures required fields are present and cardinality constraints are met"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"Binding Validation"}),": Validates code bindings against ValueSets and CodeSystems"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"Extension Validation"}),": Validates extensions and their structure"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"Invariant Validation"}),": Validates FHIRPath invariants defined in StructureDefinitions"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"Questionnaire Response Validation"}),": Specialized validation for QuestionnaireResponse resources"]}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,a.jsx)(i.h3,{id:"validating-a-fhir-resource",children:"Validating a FHIR Resource"}),"\n",(0,a.jsxs)(i.p,{children:["The simplest way to validate a FHIR resource is using the ",(0,a.jsx)(i.code,{children:"FhirValidationEngine"}),":"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"import 'package:fhir_r4/fhir_r4.dart';\nimport 'package:fhir_r4_validation/fhir_r4_validation.dart';\n\nvoid main() async {\n  // Create a patient resource\n  final patient = Patient(\n    name: [\n      HumanName(\n        family: 'Doe'.toFhirString,\n        given: ['John'.toFhirString],\n      ),\n    ],\n  );\n\n  // Create validation engine\n  final validator = FhirValidationEngine();\n\n  // Validate the resource\n  final results = await validator.validateFhirResource(\n    structureToValidate: patient,\n  );\n\n  // Check for errors\n  if (results.hasErrors) {\n    print('Validation errors found:');\n    for (final error in results.results.where((r) => r.severity == Severity.error)) {\n      print('  ${error.path}: ${error.diagnostics}');\n    }\n  } else {\n    print('Resource is valid!');\n  }\n}\n"})}),"\n",(0,a.jsx)(i.h3,{id:"validating-from-json",children:"Validating from JSON"}),"\n",(0,a.jsx)(i.p,{children:"You can also validate resources from JSON strings or maps:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"// From JSON string\nfinal jsonString = '''\n{\n  \"resourceType\": \"Patient\",\n  \"name\": [{\n    \"family\": \"Doe\",\n    \"given\": [\"John\"]\n  }]\n}\n''';\n\nfinal results = await validator.validateFhirString(\n  structureToValidate: jsonString,\n);\n\n// From JSON map\nfinal jsonMap = {\n  'resourceType': 'Patient',\n  'name': [\n    {\n      'family': 'Doe',\n      'given': ['John']\n    }\n  ]\n};\n\nfinal results = await validator.validateFhirMap(\n  structureToValidate: jsonMap,\n);\n"})}),"\n",(0,a.jsx)(i.h2,{id:"validation-results",children:"Validation Results"}),"\n",(0,a.jsxs)(i.p,{children:["The ",(0,a.jsx)(i.code,{children:"ValidationResults"})," class provides detailed information about validation outcomes:"]}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"final results = await validator.validateFhirResource(\n  structureToValidate: patient,\n);\n\n// Check if there are any errors\nif (results.hasErrors) {\n  // Handle errors\n}\n\n// Access all results\nfor (final result in results.results) {\n  print('${result.severity}: ${result.path} - ${result.diagnostics}');\n}\n\n// Get results by severity\nfinal errors = results.results.where((r) => r.severity == Severity.error);\nfinal warnings = results.results.where((r) => r.severity == Severity.warning);\nfinal info = results.results.where((r) => r.severity == Severity.information);\n\n// Convert to JSON\nfinal jsonResults = results.toJson();\n"})}),"\n",(0,a.jsx)(i.h3,{id:"validationdiagnostics",children:"ValidationDiagnostics"}),"\n",(0,a.jsx)(i.p,{children:"Each validation result contains:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:"path"}),": The path to the element that failed validation"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:"diagnostics"}),": A description of the validation issue"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:"severity"}),": The severity level (error, warning, or information)"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.code,{children:"line"})," and ",(0,a.jsx)(i.code,{children:"column"}),": Location information (if available)"]}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"validation-types",children:"Validation Types"}),"\n",(0,a.jsx)(i.p,{children:"The validation engine performs several types of validation:"}),"\n",(0,a.jsx)(i.h3,{id:"1-structure-validation",children:"1. Structure Validation"}),"\n",(0,a.jsx)(i.p,{children:"Validates that the resource structure matches its StructureDefinition:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"// Validates:\n// - All elements are defined in the StructureDefinition\n// - Element types are correct\n// - Nested structures are valid\n"})}),"\n",(0,a.jsx)(i.h3,{id:"2-cardinality-validation",children:"2. Cardinality Validation"}),"\n",(0,a.jsx)(i.p,{children:"Ensures that required fields are present and cardinality constraints are met:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"// Validates:\n// - Required elements (min > 0) are present\n// - Maximum cardinality is not exceeded\n// - Array sizes are within bounds\n"})}),"\n",(0,a.jsx)(i.h3,{id:"3-binding-validation",children:"3. Binding Validation"}),"\n",(0,a.jsx)(i.p,{children:"Validates code bindings against ValueSets and CodeSystems:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"// Validates:\n// - Code values are valid according to the binding\n// - CodeSystem references are correct\n// - ValueSet expansions are valid\n"})}),"\n",(0,a.jsx)(i.h3,{id:"4-extension-validation",children:"4. Extension Validation"}),"\n",(0,a.jsx)(i.p,{children:"Validates extensions and their structure:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"// Validates:\n// - Extension URLs are valid\n// - Extension structures match their definitions\n// - Required extension elements are present\n"})}),"\n",(0,a.jsx)(i.h3,{id:"5-invariant-validation",children:"5. Invariant Validation"}),"\n",(0,a.jsx)(i.p,{children:"Validates FHIRPath invariants defined in StructureDefinitions:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"// Validates:\n// - FHIRPath expressions evaluate correctly\n// - Invariant conditions are met\n"})}),"\n",(0,a.jsx)(i.h2,{id:"providing-structuredefinitions",children:"Providing StructureDefinitions"}),"\n",(0,a.jsx)(i.p,{children:"By default, the validator will attempt to fetch StructureDefinitions automatically. However, you can provide your own:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"// Provide a StructureDefinition\nfinal structureDef = StructureDefinition(\n  url: 'http://hl7.org/fhir/StructureDefinition/Patient'.toFhirUri,\n  // ... structure definition content\n);\n\nfinal results = await validator.validateFhirResource(\n  structureToValidate: patient,\n  structureDefinition: structureDef,\n);\n"})}),"\n",(0,a.jsx)(i.h2,{id:"questionnaire-response-validation",children:"Questionnaire Response Validation"}),"\n",(0,a.jsx)(i.p,{children:"The package includes specialized validation for QuestionnaireResponse resources:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"import 'package:fhir_r4_validation/fhir_r4_validation.dart';\n\n// Validate a QuestionnaireResponse against its Questionnaire\nfinal results = await validateQuestionnaireResponse(\n  questionnaireResponse: questionnaireResponse,\n  questionnaire: questionnaire,\n  resourceCache: resourceCache,\n);\n"})}),"\n",(0,a.jsx)(i.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,a.jsx)(i.p,{children:"The validator provides detailed error information:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"try {\n  final results = await validator.validateFhirResource(\n    structureToValidate: patient,\n  );\n  \n  if (results.hasErrors) {\n    // Process errors\n    for (final error in results.results.where((r) => r.severity == Severity.error)) {\n      print('Error at ${error.path}: ${error.diagnostics}');\n    }\n  }\n} catch (e) {\n  print('Validation failed: $e');\n}\n"})}),"\n",(0,a.jsx)(i.h2,{id:"advanced-usage",children:"Advanced Usage"}),"\n",(0,a.jsx)(i.h3,{id:"custom-http-client",children:"Custom HTTP Client"}),"\n",(0,a.jsx)(i.p,{children:"You can provide a custom HTTP client for fetching StructureDefinitions:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"import 'package:http/http.dart';\n\nfinal client = Client();\nfinal results = await validator.validateFhirResource(\n  structureToValidate: patient,\n  client: client,\n);\n"})}),"\n",(0,a.jsx)(i.h3,{id:"resource-cache",children:"Resource Cache"}),"\n",(0,a.jsx)(i.p,{children:"For better performance when validating multiple resources, you can use a resource cache:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"import 'package:fhir_r4_path/fhir_r4_path.dart';\n\nfinal resourceCache = CanonicalResourceCache();\n\n// The validator will use the cache to avoid re-fetching StructureDefinitions\n"})}),"\n",(0,a.jsx)(i.h2,{id:"example-complete-validation-workflow",children:"Example: Complete Validation Workflow"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{className:"language-dart",children:"import 'package:fhir_r4/fhir_r4.dart';\nimport 'package:fhir_r4_validation/fhir_r4_validation.dart';\n\nFuture<void> validatePatient(Patient patient) async {\n  final validator = FhirValidationEngine();\n  \n  final results = await validator.validateFhirResource(\n    structureToValidate: patient,\n  );\n  \n  if (results.hasErrors) {\n    print('Validation failed with ${results.results.where((r) => r.severity == Severity.error).length} errors:');\n    \n    for (final error in results.results.where((r) => r.severity == Severity.error)) {\n      print('  \u274c ${error.path}: ${error.diagnostics}');\n    }\n    \n    for (final warning in results.results.where((r) => r.severity == Severity.warning)) {\n      print('  \u26a0\ufe0f  ${warning.path}: ${warning.diagnostics}');\n    }\n  } else {\n    print('\u2705 Patient resource is valid!');\n    \n    if (results.results.any((r) => r.severity == Severity.warning)) {\n      print('Warnings:');\n      for (final warning in results.results.where((r) => r.severity == Severity.warning)) {\n        print('  \u26a0\ufe0f  ${warning.path}: ${warning.diagnostics}');\n      }\n    }\n  }\n  \n  // Export results as JSON\n  final jsonResults = results.toJson();\n  print('\\nValidation results (JSON):');\n  print(jsonEncode(jsonResults));\n}\n"})}),"\n",(0,a.jsx)(i.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:"StructureDefinitions are cached automatically to avoid redundant fetching"}),"\n",(0,a.jsxs)(i.li,{children:["For batch validation, reuse the ",(0,a.jsx)(i.code,{children:"FhirValidationEngine"})," instance"]}),"\n",(0,a.jsx)(i.li,{children:"Consider providing StructureDefinitions directly if you have them available"}),"\n",(0,a.jsxs)(i.li,{children:["Use a ",(0,a.jsx)(i.code,{children:"ResourceCache"})," for better performance with multiple validations"]}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"integration-with-other-packages",children:"Integration with Other Packages"}),"\n",(0,a.jsx)(i.p,{children:"The validation package integrates seamlessly with other FHIR-FLI packages:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"fhir_r4"}),": Uses FHIR resource models"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"fhir_r4_path"}),": Uses FHIRPath for invariant validation"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"fhir_r4_db"}),": Can validate resources before saving to the database"]}),"\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.strong,{children:"fhir_r4_at_rest"}),": Can validate resources before sending to a FHIR server"]}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,a.jsxs)(i.p,{children:["The ",(0,a.jsx)(i.code,{children:"fhir_r4_validation"})," package provides comprehensive validation capabilities for FHIR resources, ensuring they conform to the FHIR specification. Whether you're validating resources before saving them, before sending them to a server, or as part of a data quality pipeline, this package provides the tools you need to ensure FHIR compliance."]})]})}function h(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>l});var r=n(6540);const a={},t=r.createContext(a);function s(e){const i=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(t.Provider,{value:i},e.children)}}}]);
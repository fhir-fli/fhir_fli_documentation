<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>Select Patient Series - The Cicada Vaccine Forecasting Engine and Guide v0.1.0</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
  	<link href="assets/css/cqf.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->

    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="apple-touch-icon-precomposed" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>
    <script type="text/javascript" src="assets/js/mermaid.js"></script>
    <script type="text/javascript" src="assets/js/mermaid-init.js"></script>
    <style type="text/css">h2{--heading-prefix:"7"}
    h3,h4,h5,h6{--heading-prefix:"7"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->

        <!-- Placeholder for child template header declarations -->


        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">The Cicada Vaccine Forecasting Engine and Guide</span>
            <br/>
            <span style="display:inline-block;">0.1.0 - ci-build


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="index.html">Home</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Guide
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="01_preparation.html">Preparation</a>
      </li>
      <li>
        <a href="02_logical-specification-concepts.html">Logical Specification Concepts</a>
      </li>
      <li>
        <a href="03_processing-model.html">Processing Model</a>
      </li>
      <li>
        <a href="04_evaluate-vaccine-dose-administered.html">Evaluate Vaccine Dose Administered</a>
      </li>
      <li>
        <a href="05_forecast-dates-and-reasons.html">Forecast Dates and Reasons</a>
      </li>
      <li>
        <a href="06_select-patient-series.html">Select Patient Series</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="artifacts.html">Artifacts</a>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><b>Select Patient Series</b></li>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">The Cicada Vaccine Forecasting Engine and Guide - Local Development build (v0.1.0) built by the FHIR (HL7® FHIR® Standard) Build Tools. See the <a href='http://fhirfli.dev/fhir/ig/cicada/history.html'>Directory of published versions</a></p><!--EndReleaseHeader-->
  <h2>Select Patient Series</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#a-quick-note-on-series-groups" id="markdown-toc-a-quick-note-on-series-groups">A quick note on Series Groups</a></li>
  <li><a href="#pre-filter-patient-series" id="markdown-toc-pre-filter-patient-series">Pre-filter Patient Series</a></li>
  <li><a href="#identify-one-prioritized-patient-series" id="markdown-toc-identify-one-prioritized-patient-series">Identify One Prioritized Patient Series</a></li>
  <li><a href="#classify-scorable-patient-series" id="markdown-toc-classify-scorable-patient-series">Classify Scorable Patient Series</a></li>
  <li><a href="#score-complete-patient-series" id="markdown-toc-score-complete-patient-series">Score Complete Patient Series</a></li>
  <li><a href="#score-in-process-patient-series" id="markdown-toc-score-in-process-patient-series">Score In-Process Patient Series</a></li>
  <li><a href="#score-no-valid-doses" id="markdown-toc-score-no-valid-doses">Score No Valid Doses</a></li>
  <li><a href="#select-the-prioritized-patient-series" id="markdown-toc-select-the-prioritized-patient-series">Select the Prioritized Patient Series</a></li>
</ul>

</div>
<h3 id="a-quick-note-on-series-groups">A quick note on Series Groups</h3>

<p>Before diving in, this section is going to start using the Series Group as part of the logic. There are Vaccine Groups (MMR, Tdap, etc), which are broken down into antigens. Each antigen has multiple series that apply to it. However, these series can be grouped together. At the beginning of each series, it looks something like:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"seriesName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HepA 2-dose series"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"targetDisease"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HepA"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"seriesVaccineGroup"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HepA"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"seriesType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Standard"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"equivalentSeriesGroups"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"defaultSeries"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yes"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"productPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"seriesGroupName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Standard"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"seriesGroup"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"seriesPriority"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"seriesPreference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"minAgeToStart"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"maxAgeToStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19 years"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">seriesGroup</code> is what we'll be working with. Series within the same group are compared against each other during scoring.</p>

<h3 id="pre-filter-patient-series">Pre-filter Patient Series</h3>

<p>A relevant patient series (one we determined was applicable to the patient earlier) must be considered a <strong>scorable</strong> patient series if <strong>all</strong> of the following are true:</p>

<ol>
  <li>
    <p><strong>Priority</strong>: The series must have the same or greater priority as other series being considered. Each series has a <code class="language-plaintext highlighter-rouge">seriesPriority</code> field marked with letters ("A", "B", "C", etc). If any possible series has an "A" seriesPriority, then only series with "A" priority are considered. If the highest is "B", then only "B" series are considered, etc.</p>
  </li>
  <li>
    <p><strong>Minimum age</strong>: The patient must meet the starting age requirements. Each series has a <code class="language-plaintext highlighter-rouge">minAgeToStart</code> field.</p>
  </li>
  <li>
    <p><strong>Maximum age</strong>: The date administered of the first valid dose in the series must have been given before the maximum age to start date. If this is the first dose (no doses given yet), then the patient must be younger than the maximum age to start date.</p>
  </li>
</ol>

<h3 id="identify-one-prioritized-patient-series">Identify One Prioritized Patient Series</h3>

<p>Before scoring, we check if there's an obvious winner. If there is, we can skip the whole scoring process for that series group.</p>

<table border="1">
  <tr>
    <th>Conditions</th>
    <th colspan="6">Rules</th>
  </tr>
  <tr>
    <td>There are no scorable series for the antigen, but 1 relevant series is identified as the default</td>
    <td>Yes</td>
    <td>No</td>
    <td>No</td>
    <td>No</td>
    <td>No</td>
    <td>No</td>
  </tr>
  <tr>
    <td>There is only 1 scorable series for that antigen</td>
    <td>-</td>
    <td>Yes</td>
    <td>No</td>
    <td>No</td>
    <td>No</td>
    <td>No</td>
  </tr>
  <tr>
    <td>There is only 1 complete series for that antigen</td>
    <td>-</td>
    <td>-</td>
    <td>Yes</td>
    <td>No</td>
    <td>No</td>
    <td>No</td>
  </tr>
  <tr>
    <td>There is only 1 in-process series and no complete series for the antigen</td>
    <td>-</td>
    <td>-</td>
    <td>-</td>
    <td>Yes</td>
    <td>No</td>
    <td>No</td>
  </tr>
  <tr>
    <td>There are no series with any valid doses, but one of the series is the default</td>
    <td>-</td>
    <td>-</td>
    <td>-</td>
    <td>-</td>
    <td>Yes</td>
    <td>No</td>
  </tr>
  <tr>
    <th>Which series should be prioritized?</th>
    <td>Default series</td>
    <td>Lone scorable series</td>
    <td>Lone complete series</td>
    <td>Lone in-process series</td>
    <td>Default series</td>
    <td>None: proceed to scoring</td>
  </tr>
</table>

<p>Some definitions:</p>
<ul>
  <li>A <strong>complete</strong> series has a status of 'complete' (all target doses satisfied)</li>
  <li>The <strong>default</strong> series is the one with <code class="language-plaintext highlighter-rouge">"defaultSeries": "Yes"</code></li>
  <li>An <strong>in-process</strong> series has at least one target dose that has been satisfied, but the series is not yet complete</li>
</ul>

<p>If a prioritized series is found, that's the winner for that series group, and we don't need to score the others (for that group). If there are other series groups for the antigen, we do still evaluate those.</p>

<h3 id="classify-scorable-patient-series">Classify Scorable Patient Series</h3>

<p>If there isn't a prioritized series, we need to score them. But first, we classify them to determine which scoring rules to use.</p>

<table border="1">
  <tr>
    <th>Conditions</th>
    <th colspan="3">Rules</th>
  </tr>
  <tr>
    <td>&ge; 2 complete series?</td>
    <td>Yes</td>
    <td>No</td>
    <td>No</td>
  </tr>
  <tr>
    <td>&ge; 2 in-process series, and 0 complete series?</td>
    <td>-</td>
    <td>Yes</td>
    <td>No</td>
  </tr>
  <tr>
    <td>Do all series have 0 valid doses?</td>
    <td>-</td>
    <td>No</td>
    <td>Yes</td>
  </tr>
  <tr>
    <th>Outcomes</th>
    <td>Score only the complete series</td>
    <td>Score only the in-process series</td>
    <td>Score all series</td>
  </tr>
</table>

<h3 id="score-complete-patient-series">Score Complete Patient Series</h3>

<p>For each scoring criterion, the math works the same way:</p>
<ul>
  <li>If <strong>only 1</strong> scorable series meets the condition, it gets <strong>positive</strong> points</li>
  <li>If <strong>2 or more</strong> meet the condition, none get awarded extra points (but they don't lose any either)</li>
  <li>If a series <strong>does not</strong> meet the condition, it gets <strong>negative</strong> points</li>
</ul>

<table border="1">
  <tr>
    <th>Conditions</th>
    <th>True for only 1 scorable series</th>
    <th>True for &ge; 2 scorable series</th>
    <th>Not true for scorable series</th>
  </tr>
  <tr>
    <td>Scorable series has the most valid doses</td>
    <td>+1</td>
    <td>-</td>
    <td>-1</td>
  </tr>
  <tr>
    <td>Scorable series is a product series and has all valid doses</td>
    <td>+1</td>
    <td>-</td>
    <td>-1</td>
  </tr>
  <tr>
    <td>Scorable series is earliest to complete</td>
    <td>+2</td>
    <td>+1</td>
    <td>-1</td>
  </tr>
</table>

<p>Note that "earliest to complete" gives +1 even when tied (unlike the other criteria). This gives extra weight to finishing sooner.</p>

<h3 id="score-in-process-patient-series">Score In-Process Patient Series</h3>

<table border="1">
  <tr>
    <th>Conditions</th>
    <th>True for only 1 scorable series</th>
    <th>True for &ge; 2 scorable series</th>
    <th>Not true for scorable series</th>
  </tr>
  <tr>
    <td>Scorable series is a product series and has all valid doses</td>
    <td>+2</td>
    <td>-</td>
    <td>-2</td>
  </tr>
  <tr>
    <td>Scorable series is completeable (patient can still finish it)</td>
    <td>+3</td>
    <td>-</td>
    <td>-3</td>
  </tr>
  <tr>
    <td>Scorable series has the most valid doses</td>
    <td>+2</td>
    <td>-</td>
    <td>-2</td>
  </tr>
  <tr>
    <td>Scorable series is closest to completion (fewest remaining doses)</td>
    <td>+2</td>
    <td>-</td>
    <td>-2</td>
  </tr>
  <tr>
    <td>Scorable series can finish earliest</td>
    <td>+1</td>
    <td>-</td>
    <td>-1</td>
  </tr>
</table>

<p>"Completeable" is the heaviest weight here (+3/-3), because if a series can't be completed, there's no point recommending it.</p>

<h3 id="score-no-valid-doses">Score No Valid Doses</h3>

<p>When no series has any valid doses yet, the scoring is different:</p>

<table border="1">
  <tr>
    <th>Conditions</th>
    <th>True for only 1 scorable series</th>
    <th>True for &ge; 2 scorable series</th>
    <th>Not true for scorable series</th>
  </tr>
  <tr>
    <td>Scorable series can start earliest</td>
    <td>+1</td>
    <td>-</td>
    <td>-1</td>
  </tr>
  <tr>
    <td>Scorable series is completeable</td>
    <td>+1</td>
    <td>-</td>
    <td>-1</td>
  </tr>
  <tr>
    <td>Scorable series is a product patient series</td>
    <td>-1</td>
    <td>-</td>
    <td>+1</td>
  </tr>
</table>

<p>Note that product series scoring is <strong>inverted</strong> here: being a product series is a <strong>disadvantage</strong> when there are no valid doses. This is because product series are more restrictive (they require a specific product/manufacturer), and when starting fresh, a more flexible series is preferred.</p>

<h3 id="select-the-prioritized-patient-series">Select the Prioritized Patient Series</h3>

<p>This one is easy. After all the scoring is done, the series with the highest score wins. If there's a tie, the series with the higher preference value (from <code class="language-plaintext highlighter-rouge">seriesPreference</code> in the supporting data) takes priority.</p>

<p>The winning series becomes the <strong>prioritized patient series</strong> for that series group. Its forecast is what gets recommended to the patient for that antigen.</p>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript" src="assets/js/window-hash.js"> </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div class="inner-wrapper">
        <p>
          IG &#169; 2024+ <a style="color:var(--footer-hyperlink-text-color)" href="http://fhirfli.dev">FHIR-FLI</a>.  Package cicada.ig#0.1.0 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Wed, Feb 11, 2026 14:37-0500">2026-02-11</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                 
                
          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->

  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script type="text/javascript" src="assets/js/anchor-hover.js"> </script>
  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

